<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>This add-in will insert 'CONFIDENTIAL' in the current selection of the slide.</p>
    <button onclick="addConfidentialText()">Add Watermarl</button>
</body>

<script>
    Office.onReady((info) => {
        // Check that we loaded into PowerPoint
        if (info.host === Office.HostType.PowerPoint) {
            document.getElementById("addButton").onclick = addConfidentialText;
        }
    });

    async function addConfidentialText() {
        try {
            const selection = Office.context.document.getSelectedData();

            // Check if there's a selected range
            if (selection && selection.value) {
                const confidentialText = "<div style='font-size: 70px;'>CONFIDENTIAL</div>";
                await Office.context.document.setSelectedDataAsync(confidentialText, { coercionType: Office.CoercionType.Html });
            } else {
                console.log("No selection found.");
            }
        } catch (error) {
            console.error("Error inserting confidential text:", error);
        }
    }

</script>

</html>
